diff --git a/code/VHDLOperators/src/UserInterface.cpp b/code/VHDLOperators/src/UserInterface.cpp
index 0b2e3d8a..99999999 100644
--- a/code/VHDLOperators/src/UserInterface.cpp
+++ b/code/VHDLOperators/src/UserInterface.cpp
@@
-#include <regex>
-#include <string>
-#include <sys/stat.h>
-// TODO check the hard mult threshold
+#include <regex>
+#include <string>
+#include <sys/stat.h>
+// TODO check the hard mult threshold
+
+#ifndef FLOPOCO_GIT_HASH
+#define FLOPOCO_GIT_HASH unknown
+#endif
+#define FLOPOCO_STRINGIFY_DETAIL(x) #x
+#define FLOPOCO_STRINGIFY(x) FLOPOCO_STRINGIFY_DETAIL(x)
@@
     if(argc == 2 && string(argv[1]) == "--version") {
 #ifdef FLOPOCO_VERSION_MAJOR
-        printf("%d.%d.%d:%s\n", FLOPOCO_VERSION_MAJOR, FLOPOCO_VERSION_MINOR, FLOPOCO_VERSION_PATCH, FLOPOCO_GIT_HASH);
+        printf("%d.%d.%d:%s\n", FLOPOCO_VERSION_MAJOR, FLOPOCO_VERSION_MINOR, FLOPOCO_VERSION_PATCH, FLOPOCO_STRINGIFY(FLOPOCO_GIT_HASH));
         exit(EXIT_SUCCESS);
 #else
         exit(EXIT_FAILURE);
 #endif
     }
diff --git a/code/VHDLOperators/include/flopoco/ConstMult/IntConstMultShiftAddOptTernary.hpp b/code/VHDLOperators/include/flopoco/ConstMult/IntConstMultShiftAddOptTernary.hpp
index 12345678..abcdef01 100644
--- a/code/VHDLOperators/include/flopoco/ConstMult/IntConstMultShiftAddOptTernary.hpp
+++ b/code/VHDLOperators/include/flopoco/ConstMult/IntConstMultShiftAddOptTernary.hpp
@@
-#if defined(HAVE_PAGLIB) && defined(HAVE_OSCM)
+#if defined(HAVE_PAGLIB) && defined(HAVE_OSCM) && defined(HAVE_SCALP)
 class IntConstMultShiftAddOptTernary : public IntConstMultShiftAdd {
     public:
     IntConstMultShiftAddOptTernary(Operator* parentOp, Target* target, int wIn, int coeff, bool isSigned, int errorBudget);
     static OperatorPtr parseArguments(OperatorPtr parentOp, Target* target, vector<string>& args, UserInterface& ui);
     static TestList unitTest(int testLevel);
